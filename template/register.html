{{template "layout.html"}} {{define "title"}} forum {{end}} {{define "content"}}
<form id="login-form" class="flex flex-colum gap-4" method="post">
  <h2>Create a new account</h2>
  <div class="box"></div>
  <input type="text" placeholder="Email" name="email" />
  <input type="text" placeholder="Username" name="username" />
  <input type="password" placeholder="Password" name="password" />
  <button type="submit">Login</button>
</form>
{{end}}

<script>
  let formEl = document.getElementById("login-form");
  let boxEl = document.querySelector(".box");
  formEl.addEventListener("submit", (e) => {
    e.preventDefault();
    let form = new FormData(formEl);
    let data = {
      email: form.get("email").trim(),
      username: form.get("username").trim(),
      password: form.get("password").trim(),
    };

    // if (data.email === "" || data.user == "" || data.password == "") {
    //   writeError(
    //     "Please make sure to fill in all required fields before submitting the form."
    //   );
    //   return;
    // }
    register(data);
    console.log(data);
  });

  async function register(userData) {
    try {
      const response = await fetch("/api/register", {
        method: "POST",
        body: JSON.stringify(userData),
      });
      if (!response.ok) {
        console.log(response);
      }
      let responseData = await response.json();
      console.log(responseData);
    } catch (error) {}
  }

  function writeError(msg) {
    boxEl.classList.remove("success");
    boxEl.classList.add("error");
    boxEl.innerHTML = msg;
  }

  function writeSucc(msg) {
    boxEl.classList.remove("error");
    boxEl.classList.add("success");
    boxEl.innerHTML = msg;
  }
</script>
